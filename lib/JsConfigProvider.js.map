{"version":3,"sources":["../src/JsConfigProvider.js"],"names":["fs","load_","require","JsonConfigProvider","JsConfigProvider","logger","pathExists","filePath","config","log","save_","outputFile","JSON","stringify","module","exports"],"mappings":"AAAA;;;;AAEA,MAAM;AAAEA,EAAAA,EAAF;AAAMC,EAAAA;AAAN,IAAgBC,OAAO,CAAC,WAAD,CAA7B;;AAEA,MAAMC,kBAAkB,GAAGD,OAAO,CAAC,yBAAD,CAAlC;;AAOA,MAAME,gBAAN,SAA+BD,kBAA/B,CAAkD;AAKnC,QAALF,KAAK,CAACI,MAAD,EAAS;AAChB,QAAI,MAAML,EAAE,CAACM,UAAH,CAAc,KAAKC,QAAnB,CAAV,EAAwC;AACpC,WAAKC,MAAL,GAAc,MAAMP,KAAK,CAAC,KAAKM,QAAN,CAAzB;;AACA,UAAIF,MAAJ,EAAY;AACRA,QAAAA,MAAM,CAACI,GAAP,CACI,MADJ,EAEK,iCAAgC,KAAKF,QAAS,GAFnD;AAIH;AACJ,KARD,MAQO;AACH,WAAKC,MAAL,GAAc,EAAd;AACH;;AAED,WAAO,KAAKA,MAAZ;AACH;;AAMU,QAALE,KAAK,GAAG;AACV,WAAOV,EAAE,CAACW,UAAH,CACH,KAAKJ,QADF,EAEH,sBAAsBK,IAAI,CAACC,SAAL,CAAe,KAAKL,MAApB,EAA4B,IAA5B,EAAkC,CAAlC,CAAtB,GAA6D,GAF1D,CAAP;AAIH;;AA9B6C;;AAiClDM,MAAM,CAACC,OAAP,GAAiBX,gBAAjB","sourcesContent":["'use strict';\n\nconst { fs, load_ } = require('@genx/sys');\n\nconst JsonConfigProvider = require('./JsonConfigProvider.js');\n\n/**\n * JavaScirpt module file config data source\n * @class JsConfigProvider\n * @extends JsonConfigProvider\n */\nclass JsConfigProvider extends JsonConfigProvider {\n    /**\n     * Start loading the config files\n     * @returns {Promise.<object>}\n     */\n    async load_(logger) {\n        if (await fs.pathExists(this.filePath)) {\n            this.config = await load_(this.filePath); // load js into sandbox\n            if (logger) {\n                logger.log(\n                    'info',\n                    `Configuration is loaded from \"${this.filePath}\"`\n                );\n            }\n        } else {\n            this.config = {};\n        }\n\n        return this.config;\n    }\n\n    /**\n     * Start saving the config to files\n     * @returns {Promise.<*>}\n     */\n    async save_() {\n        return fs.outputFile(\n            this.filePath,\n            'module.exports = ' + JSON.stringify(this.config, null, 4) + ';'\n        );\n    }\n}\n\nmodule.exports = JsConfigProvider;\n"],"file":"JsConfigProvider.js"}